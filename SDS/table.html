<html>
    <head>
        <style>
            table{
            width: 500px;
            
            }
            td{
            width: 100px;
            }
        </style>
    </head>
    <body>
        
        <form name="my" >
            <table border="2px solid black" align="center" id="myT">
                <tr> <th>BackSight</th> <th>Inter Sight</th> <th>ForeSight</th> <th>Rice</th> <th>Fall</th> <th>Reduse Level</th> <th>Length</th> </tr>
                <tr> <td><input type="text"></td> <td><input type="text"></td> <td><input type="text"></td> <td></td> <td></td> <td></td> <td><input type="text"></td> </tr>
                <tr> <td><input type="text"></td> <td><input type="text"></td> <td><input type="text"></td> <td></td> <td></td> <td></td> <td><input type="text"></td> </tr>
                <tr> <td><input type="text"></td> <td><input type="text"></td> <td><input type="text"></td> <td></td> <td></td> <td></td> <td><input type="text"></td> </tr>
                <tr> <td><input type="text"></td> <td><input type="text"></td> <td><input type="text"></td> <td></td> <td></td> <td></td> <td><input type="text"></td> </tr>
                <tr> <td><input type="text"></td> <td><input type="text"></td> <td><input type="text"></td> <td></td> <td></td> <td></td> <td><input type="text"></td> </tr>
                <tr> <td><input type="text"></td> <td><input type="text"></td> <td><input type="text"></td> <td></td> <td></td> <td></td> <td><input type="text"></td> </tr>
             </table>
        </form>
       
      <form name="my2">
            Level:<input type="text">
        </form>
        
            <button type="button" onClick="myf()" >Calculat</button> <button type="button" onClick="creatNewRow()" >New Row</button>
        
        <script>
            function myf()
            {
                var col1=[];//array structure for store collume1 data
                var col2=[];//array structure for store collume2 data
                var col3=[];//array structure for store collume3 data
                var col7=[];//array structure for store collume7 data
                var res1=[];//store coerted data from col1
                var res2=[];//store coerted data from col2
                var res3=[];//store coerted data from col3
                var res7=[];//store coerted data from col7
                var level;
                var count1=0;
                var count2=0;
                var count3=0;
                var count4=0;
                var NoOfRows=document.getElementById("myT").rows.length;
                var sizeOfTable=NoOfRows*7;
                var sizeOfForm=(NoOfRows-1)*4;
               /* var x=document.my.elements[sizeOfForm-1].value                  
                document.getElementById("d").innerHTML=x;*/
               
               for(i=0;i<(sizeOfForm-3);i=i+4)
                {
                    col1[count1]=document.my.elements[i].value;
                    count1++;                
                } 
                
                for(i=1;i<(sizeOfForm-2);i=i+4)
                {
                    col2[count2]=document.my.elements[i].value;
                    count2++;                
                } 
                
                for(i=2;i<(sizeOfForm-1);i=i+4)
                {
                    col3[count3]=document.my.elements[i].value;
                    count3++;                
                }
                
                for(i=3;i<(sizeOfForm);i=i+4)
                {
                    col7[count4]=document.my.elements[i].value;
                    count4++;                
                }
                
                
                var lev=document.my2.elements[0].value;
                level=parseFloat(lev);
                
                for(i=1;i<NoOfRows;i++)
                {
                    res1.push(+col1[i-1]);
                    res2.push(+col2[i-1]);
                    res3.push(+col3[i-1]);
                    res7.push(+col7[i-1]);
                }                
               
                
                
                if(res1[0]==0)
                {
                    alert("Error");
                }
                else
                {
                     for(j=0;j<(NoOfRows-1);j++)
                     {
                         if(res1[j]!==0)
                         {
                             var result=res1[j]*1000-res2[j+1]*1000;
                         }
                         else if(res2[j+1]!==0)
                         {
                             var result=res2[j]*1000-res2[j+1]*1000;
                         }
                         else if(res3[j+1]!=0)
                         {
                             var result=res2[j]*1000-res3[j+1]*1000;
                         }
                         else
                         {
                             alert("Error in row "+j)
                         }
                         
                         if(result<0)
                         {                        
                            document.getElementById("myT").rows[j+2].cells[3].innerHTML=result/1000;
                         }
                         else
                         {
                              document.getElementById("myT").rows[j+2].cells[4].innerHTML=result/1000;
                         }
                            level=(level*1000+result)/1000;
                            //document.getElementById("myT").rows[0].cells[5].innerHTML=level;
                            document.getElementById("myT").rows[j+2].cells[5].innerHTML=level;  
                            document.getElementById("myT").rows[1].cells[5].innerHTML=lev;  
                        
                     }
                    
                   /* var x = document.getElementById("myT").rows.length;
                    document.getElementById("d").innerHTML=x;*/
                }   
                
                for(i=1;i<NoOfRows;i++)
                {
                   document.getElementById("d").innerHTML=res7[i-1]; 
                }
            }
            
            function  creatNewRow()
            {
                var table = document.getElementById("myT");
                var newRow=table.insertRow(-1);
                
                var cell0=newRow.insertCell(0);
                var cell1=newRow.insertCell(1);                
                var cell2=newRow.insertCell(2);
                var cell3=newRow.insertCell(3);
                var cell4=newRow.insertCell(4);
                var cell5=newRow.insertCell(5);
                var cell6=newRow.insertCell(6);
                
                /*var input0 = document.createElement("input");
                input0.type = "text";
                var input1 = document.createElement("input");
                input1.type = "text";
                var input2 = document.createElement("input");
                input2.type = "text";
                
                cell0.appendChild(input0);
                cell1.appendChild(input1);
                cell2.appendChild(input2);*/
                cell0.innerHTML='<input type="text">';
                cell1.innerHTML='<input type="text">';
                cell2.innerHTML='<input type="text">';
                cell6.innerHTML='<input type="text">';
            }
            
            
            
        </script>
        </body></html>